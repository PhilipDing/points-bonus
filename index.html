<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>寒假积分大放送 ✨</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <div class="page active" id="home">
            <div class="header">
                <h1>🌟 寒假积分大放送 🌟</h1>
            </div>

            <div class="points-card">
                <div class="points-number" id="totalPoints">0</div>
                <div class="points-label">⭐ 我的积分</div>
            </div>

            <button class="btn btn-signin" id="signInBtn" onclick="signIn()">
                <span class="btn-text">🎁 每日签到</span>
                <span class="btn-loading" style="display: none;">签到中...</span>
            </button>

            <div class="card">
                <h3>🎯 去玩什么呢？</h3>
                <button class="btn btn-tasks" onclick="showPage('tasks')">
                    📋 任务列表
                </button>
                <button class="btn btn-rewards" onclick="showPage('rewards')">
                    🎁 积分兑换
                </button>
                <button class="btn btn-home-quiz" onclick="showPage('quiz')">
                    🧠 问答挑战赛
                </button>
                <button class="btn btn-home-lottery" onclick="showPage('lottery')">
                    🎰 幸运抽奖
                </button>
                <button class="btn btn-home-vouchers" onclick="showPage('vouchers')">
                    🎫 我的卡券
                </button>
                <button class="btn btn-home-records" onclick="showPage('records')">
                    📝 积分记录
                </button>
            </div>
        </div>

        <div class="page" id="tasks">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>📋 任务列表 <span id="todayPointsDisplay" style="font-size: 18px; margin-left: 10px;"></span></h1>
            </div>

            <div class="collapsible" onclick="toggleAddTask()">
                <span style="font-weight: bold; font-size: 18px;">➕ 添加新任务</span>
                <span class="collapsible-arrow" id="addTaskArrow">▼</span>
            </div>

            <div class="collapsible-content" id="addTaskContent">
                <div style="margin-bottom: 10px;">
                    <input type="text" id="taskName" placeholder="任务名称"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="number" id="taskPoints" placeholder="奖励积分"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="number" id="taskMaxDailyTimes" placeholder="每日完成次数（可选，留空不限制）"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <button class="btn btn-primary" id="addTaskBtn" onclick="addCustomTask()">
                    <span class="btn-text">确认添加</span>
                    <span class="btn-loading" style="display: none;">进行中...</span>
                </button>
            </div>

            <div id="taskList"></div>
        </div>

        <div class="page" id="rewards">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>🎁 积分兑换</h1>
            </div>

            <div class="collapsible" onclick="toggleAddReward()">
                <span style="font-weight: bold; font-size: 18px;">➕ 添加新奖品</span>
                <span class="collapsible-arrow" id="addRewardArrow">▼</span>
            </div>

            <div class="collapsible-content" id="addRewardContent">
                <div style="margin-bottom: 10px;">
                    <input type="text" id="rewardName" placeholder="奖品名称"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="number" id="rewardPoints" placeholder="所需积分"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="number" id="rewardMaxDailyTimes" placeholder="每日兑换次数（可选，留空不限制）"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="rewardAvailableForLottery" style="margin-right: 8px; width: 18px; height: 18px;">
                        <span style="font-size: 14px; color: #666;">可通过抽奖获得</span>
                    </label>
                </div>
                <button class="btn btn-primary" id="addRewardBtn" onclick="addCustomReward()">
                    <span class="btn-text">确认添加</span>
                    <span class="btn-loading" style="display: none;">进行中...</span>
                </button>
            </div>

            <div id="rewardList"></div>
        </div>

        <div class="page" id="quiz">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>🧠 问答挑战赛</h1>
            </div>

            <div id="quizStart" style="text-align: center;">
                <div class="card" style="margin-bottom: 20px;">
                    <h3 style="color: #FF69B4; margin-bottom: 15px;">🎯 选一个难度开始挑战吧！</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                        一共有2道题目哦～<br>
                        ✅ 答对1题：积分不增不减<br>
                        ✅ 答对2题：积分翻倍赚！<br>
                        ❌ 全答错：积分就没了哦
                    </p>
                    <div id="quizStatus" style="margin-bottom: 15px; padding: 10px; border-radius: 10px; display: none;"></div>
                    <button class="btn btn-quiz-easy" onclick="startQuiz(1)" style="margin-bottom: 10px;">
                        🌟 简单模式（用 1 积分）
                    </button>
                    <button class="btn btn-quiz-medium" onclick="startQuiz(2)" style="margin-bottom: 10px;">
                        ⭐ 中等模式（用 2 积分）
                    </button>
                    <button class="btn btn-quiz-hard" onclick="startQuiz(5)">
                        🔥 困难模式（用 5 积分）
                    </button>
                </div>
            </div>

            <div id="quizContent" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span id="quizProgress" style="font-weight: bold; color: #FF69B4;">问答挑战</span>
                    <span id="quizBet" style="color: #4CAF50;">用了 1 积分</span>
                </div>
                <div id="quizQuestions"></div>
                <button class="btn btn-primary" id="submitQuizBtn" onclick="submitQuiz()" style="margin-top: 15px;">
                    ✨ 提交答案
                </button>
            </div>

            <div id="quizResult" style="display: none; text-align: center;">
                <div class="card">
                    <div id="resultEmoji" style="font-size: 60px; margin-bottom: 15px;"></div>
                    <div id="resultText" style="font-size: 20px; font-weight: bold; margin-bottom: 10px;"></div>
                    <div id="resultScore" style="font-size: 16px; color: #666; margin-bottom: 20px;"></div>
                    <button class="btn btn-primary" id="resultActionBtn" onclick="resetQuiz()">
                        📋 看看正确答案
                    </button>
                </div>
            </div>
        </div>

        <div class="page" id="lottery">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>🎰 幸运抽奖</h1>
            </div>

            <div id="lotteryStart" style="text-align: center;">
                <div class="card" style="margin-bottom: 20px;">
                    <h3 style="color: #FF69B4; margin-bottom: 15px;">🎁 消耗 30 积分 即可参与</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">
                        点击卡片翻转，获取您的专属奖励
                    </p>
                    <button class="btn btn-primary" id="lotteryParticipateBtn" onclick="startLottery()" style="margin-bottom: 10px;">
                        🎰 参与抽奖（30 积分）
                    </button>
                </div>
                <div id="lotteryCards" class="lottery-cards"></div>
            </div>

            <div id="lotteryPlaying" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <span style="font-weight: bold; color: #FF69B4;">🎰 幸运抽奖</span>
                    <span style="color: #4CAF50;">已消费 30 积分</span>
                </div>
                <div id="lotteryShuffledCards" class="lottery-cards"></div>
            </div>

            <div id="lotteryResult" style="display: none; text-align: center;">
                <div class="card">
                    <div id="lotteryResultEmoji" style="font-size: 60px; margin-bottom: 15px;"></div>
                    <div id="lotteryResultText" style="font-size: 20px; font-weight: bold; margin-bottom: 10px;"></div>
                    <div id="lotteryResultReward" style="font-size: 16px; color: #666; margin-bottom: 20px;"></div>
                    <button class="btn btn-primary" onclick="resetLottery()">
                        🔄 再来一次
                    </button>
                </div>
            </div>
        </div>

        <div class="page" id="vouchers">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>🎫 我的卡券</h1>
            </div>

            <div id="voucherList"></div>
        </div>

        <div class="page" id="records">
            <button class="btn btn-back" onclick="showPage('home')">
                ⬅️ 返回首页
            </button>

            <div class="header">
                <h1>📝 积分记录</h1>
            </div>

            <div class="collapsible" onclick="toggleManualAdd()">
                <span style="font-weight: bold; font-size: 18px;">➕ 手动添加积分</span>
                <span class="collapsible-arrow" id="manualAddArrow">▼</span>
            </div>

            <div class="collapsible-content" id="manualAddContent">
                <div style="margin-bottom: 10px;">
                    <input type="number" id="manualPoints" placeholder="积分数（可以是负数）"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <div style="margin-bottom: 10px;">
                    <input type="text" id="manualReason" placeholder="原因"
                           style="width: 100%; padding: 12px; border: 2px solid #ddd;
                                  border-radius: 10px; font-size: 16px; margin-bottom: 10px;">
                </div>
                <button class="btn btn-primary" onclick="addManualRecord()">
                    确认添加
                </button>
            </div>

            <div class="card record-list">
                <div id="recordList"></div>
            </div>
        </div>
    </div>

    <div class="message" id="message" onclick="this.style.display='none'"></div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">加载中...</div>
    </div>

    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>